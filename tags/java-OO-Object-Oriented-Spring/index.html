<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="(loop (print (eval (read))))" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>java, OO, Object-Oriented, Spring - (loop (print (eval (read))))</title><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro"><link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Handlee" type="text/css"><style type="text/css">.fb-share-button , .twitter-share-button {
  vertical-align: text-bottom;
  margin-left : 5px;
}
</style><link rel="stylesheet" href="/css/main.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    processEscapes: true
  }
});</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for(i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/javascript">var switchTo5x=true;</script><script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script><script type="text/javascript">stLight.options({publisher: "3df02cad-979e-4347-be4c-94fe98b99af9", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script></head><body><div id="fb-root"></div><script type="text/javascript">(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/ko_KR/sdk.js#xfbml=1&appId=783844121725729&version=v2.0";
    fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script><script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script><header class="head"><h1 class="head-title u-fl"><a href="/">(loop (print (eval (read))))</a></h1><h4 class="sub-title u-fl">;;닭집을 차리기 위한 여정</h4><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/" class="head-nav__link">Home</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2014-09-24T15:12:53.000Z" class="post__time">9월 25, 2014</time><h1 class="post__title"> <a href="/2014/09/25/OO에-대한-느낌적-느낌/">OO에 대한 느낌적 느낌</a><div style="float:right;"><div data-href="/2014/09/25/OO에-대한-느낌적-느낌/" data-layout="button_count" class="fb-share-button"></div><a href="https://twitter.com/share" data-url="http://zerosumz.github.io/2014/09/25/OO에-대한-느낌적-느낌/" data-via="k_racketeer" class="twitter-share-button"></a></div></h1></header><div class="post__main echo"><h2 id="자바"><a href="#자바" class="headerlink" title="자바"></a>자바</h2><p>나는 주로 먹고살기위해 자바를 써왔다. 현재도 많은 사람들이 바로 이 이유로 자바를 선택한다.<br>OO는 멋지다. 솔직히 간지폭발이다. 하지만 자바를 위시한 현실에서는 별로 안 멋지고 안쓰느니만 못한 부분도 간간히 보인다.</p>
<h2 id="간단한-아이디어의-구현"><a href="#간단한-아이디어의-구현" class="headerlink" title="간단한 아이디어의 구현"></a>간단한 아이디어의 구현</h2><p>예를들어 이런 수식이 있다고 하자. 흔히 예제로 자주드는 시그마 표현식이다.</p>
<blockquote>
<p>$\sum\limits_{n=a}^b f(x) = f(a) + f(a+1) + … + f(b-1) + f(b)$</p>
</blockquote>
<p>이것을 다른 평범한 언어 -  예를들어 스킴이나 자바스크립트, 좀더 내려가서 C에서는 어떻게 구현할까?</p>
<figure class="highlight scheme"><figcaption><span>스킴</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sigma</span> f a b)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> a b)</div><div class="line">      <span class="number">0</span></div><div class="line">	  (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">f</span> a)</div><div class="line">	     (<span class="name">sigma</span> f (<span class="name">add1</span> a) b))))</div><div class="line"></div><div class="line">(<span class="name">sigma</span> (<span class="name">λ</span>(<span class="name">x</span>) (<span class="name"><span class="builtin-name">*</span></span> x x)) <span class="number">1</span> <span class="number">2</span>)</div><div class="line"><span class="comment">; =&gt; 5</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><figcaption><span>자바스크립트 </span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sigma</span>(<span class="params">f,a,b</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(a &gt; b)</div><div class="line">	    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">else</span></div><div class="line">	    <span class="keyword">return</span> f(a)</div><div class="line">		       + sigma(f, a+<span class="number">1</span>, b);</div><div class="line">&#125;</div><div class="line"></div><div class="line">sigma(<span class="function"><span class="keyword">function</span>(<span class="params">x</span>)</span>&#123;<span class="keyword">return</span> x*x&#125;, <span class="number">1</span>, <span class="number">2</span>);</div><div class="line"><span class="comment">// =&gt; 5</span></div></pre></td></tr></table></figure>
<figure class="highlight c"><figcaption><span>C</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sigma</span><span class="params">(<span class="keyword">void</span>*, <span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">term</span><span class="params">(<span class="keyword">int</span>)</span></span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></div><div class="line">&#123;</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"%d"</span> ,sigma(&amp;term, <span class="number">1</span>, <span class="number">2</span>));</div><div class="line">  <span class="comment">// =&gt; 5</span></div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sigma</span><span class="params">(<span class="keyword">void</span>* f, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(a &gt; b)</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  <span class="keyword">else</span> </div><div class="line">    <span class="keyword">return</span> ((<span class="keyword">int</span>(*)(<span class="keyword">int</span>))f)(a) + sigma(f, a + <span class="number">1</span>, b);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">term</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">  <span class="keyword">return</span> i * i;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>하지만 자바에서는 OO의 이름으로 널 용서하지 않을것이다.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> example;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		System.out.println(sigma(<span class="keyword">new</span> Term() &#123;</div><div class="line">			<span class="meta">@Override</span></div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">term</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">				<span class="keyword">return</span> x * x;</div><div class="line">			&#125;</div><div class="line">		&#125;, <span class="number">1</span>, <span class="number">2</span>));</div><div class="line">	&#125;</div><div class="line">	<span class="comment">// =&gt; 5</span></div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">interface</span> <span class="title">Term</span> </span>&#123;</div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">term</span><span class="params">(<span class="keyword">int</span> x)</span></span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">sigma</span><span class="params">(Term f, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (a &gt; b)</div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="keyword">return</span> f.term(a) + sigma(f, a + <span class="number">1</span>, b);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>하지만 자바를 오래해서 그런지, (또한 돈을 벌어다줘서 그런지) 저런 표현도 나쁘지 않다는 생각이 든다.<br>아직까진 참을 수 있다. 오히려 저렇게 뭔가 <strong><em>명시적</em></strong>이고 <strong><em>구조적</em></strong>이고 <strong><em>엔터프라이지-</em></strong>하고 <strong><em>꾸띄르적</em></strong>이고 뭔가 저렇게 하면 세련되고 <strong><em>아트적인</em></strong> 느낌을 줄 것만 같다.</p>
<h2 id="복잡한-아이디어의-구현"><a href="#복잡한-아이디어의-구현" class="headerlink" title="복잡한 아이디어의 구현"></a>복잡한 아이디어의 구현</h2><p>현실세계로 돌아와서 자바로 허구헌날 만드는 웹 어플리케이션이나, 웹어플리케이션 혹은 웹 어플리케이션을 보자. 유행의 첨단을 주도하는 셀러브리티 트랜드 세터들이 매일 뭔가 프로퍼 웨이- 한 패턴이나 스타일을 들고 나온다. 그 중 하나가 aspect 다. <del>respect</del><br>자바는 이 aspect oriented programming 을 위해서 굉장히 여러 시도를 하였으며 관련 프로젝트도 여럿 나오게 된다. 현실에서 우리가 자주 보는 spring, spring-aop 가 바로 현실적인 표준으로 자리잡은 프로젝트라 할 만하다. 전자정부에도 있다 이거. 그런데,</p>
<ul>
<li>DI, aop 를 써서 무언가를 만드는것은 간지나고 좋다.</li>
<li>그런데 위에서 간단한 아이디어를 구현하는데에 이러한 복잡한 기능들이 방해가 되지는 않을까?</li>
<li>그러니까, 위에서 했던 간단히 익명 클래스 인스턴스를 넘겨받고 내부의 메서드를 호출하는등의 기능이 aop를 쓰면서도 잘 굴러갈까?</li>
</ul>
<p>경험상, 위의 예시들은 될 수도 있고, 안될 수 도 있다. 보통 jdk proxy를 쓰느냐, cglib proxy를 쓰느냐에 따라서 되고 안되는 것들이 생겨난다. 게다가 간단히 익명 클래스 인스턴스를 넘겨받는 일들을 스프링 웨이- 하게 하려면 (불과 몇년 전까지만 해도) xml 파일에다가 해당 빈의 스펙을 기술해야만 했다.</p>
<p>현실에서 가장 만나기 좋은 예시는 <strong>@Transactional</strong> 이다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentService</span>&lt;<span class="title">REQ</span> <span class="keyword">extends</span> <span class="title">PayRequestable</span>, <span class="title">RESP</span> <span class="keyword">extends</span> <span class="title">PayResponseable</span>, <span class="title">PAY</span> <span class="keyword">extends</span> <span class="title">Payment</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> PAY <span class="title">draftPayment</span><span class="params">(<span class="keyword">long</span> paymentId, REQ payRequest, Order order)</span> <span class="keyword">throws</span> SystemException</span>;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> RESP <span class="title">requestPayment</span><span class="params">(REQ payRequest, Order order)</span> <span class="keyword">throws</span> SystemException</span>;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span>(propagation = Propagation.NOT_SUPPORTED)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">completePayment</span><span class="params">(PAY payment, RESP payResponse)</span> <span class="keyword">throws</span> SystemException</span>;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span>(propagation = Propagation.NOT_SUPPORTED)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">logPayment</span><span class="params">(User user, PAY payment, RESP response)</span></span>;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span></div><div class="line">	<span class="function"><span class="keyword">public</span> PAY <span class="title">process</span><span class="params">(Order order, <span class="keyword">long</span> paymentId, REQ payRequest)</span> <span class="keyword">throws</span> SystemException </span>&#123;</div><div class="line">	    <span class="comment">// .... 결제처리를 한다.</span></div><div class="line">		<span class="keyword">return</span> payment;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span>(propagation = Propagation.NEVER)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkExistingOrder</span><span class="params">(User user)</span> </span>&#123;</div><div class="line">	    <span class="comment">// .....</span></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span>(propagation = Propagation.NESTED)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveOrderItemsAppliedPromotion</span><span class="params">(Order order)</span> </span>&#123;</div><div class="line">	    <span class="comment">// .....</span></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>위의 시그마 표현식과 다를바 없는 간단한 아이디어지만 이 코드들이 제대로 동작하게 하기위해서 어노테이션의 특성을 또 파악하고 스프링의 설정상 함정을 회피하고 또한 하나의 스타일을 강요해야한다.</p>
<ul>
<li>별로 멋있지도 않고</li>
<li>불안하고 무섭고</li>
<li>힘들다</li>
</ul>
<p>결론은 많은 사람들이 간단한 아이디어를 포기하고 괴랄한 구현을 선호하게 된다. 서비스에서 내부 메서드를 호출하지 못하므로 그냥 서비스 인터페이스를 하나 더 만들고 서비스 구현체 클래스를 하나 더 만드세요 ~ 물론 다른 방법도 있지만 그건 표준적이지 못하고 팀워-크에 민폐를 끼치는 일이에요~ 무엇보다 무슨일이 생길지 몰라요~ 라고 하는 일들이 벌어진단 얘기.</p>
<p>수백줄에 이르는 xml이 왜 아직 남아있겠는가요?</p>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p>스킴이나 이쪽 동네에는 좀 다른 클래스와 제네릭 메서드를 구현하는 방법이 있긴 하지만…</p>
<ul>
<li>아직 늦지 않았다. 공무원을 하는게 좋다. 당장 공무원 공부를 시작하면 좋다.</li>
<li>왜 이런 자바쟁이 짓을 하고 있는지 모르겠다. 이런거 한다고 누가 알아주지도 않는다.</li>
<li>결론따위 없다. 내가 뭐 아는게 있어야지. 감히 신성한 패턴에 대해 논하다니 잠깐 미쳤었나 보다.</li>
</ul>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/java-OO-Object-Oriented-Spring/" class="post__tag__link">java, OO, Object-Oriented, Spring</a></li></ul><a href="/2014/09/25/OO에-대한-느낌적-느낌/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article></main><footer class="foot"><div class="foot-copy u-fl">&copy; 2016 euhyen ~_~</div><menu class="page-menu u-fr"><li class="page-menu__item"><span title="Previous" class="page-menu__link icon-arrow-left page-menu__link--disabled"></span></li><li class="page-menu__item"><span title="Next" class="page-menu__link icon-arrow-right page-menu__link--disabled"></span></li></menu></footer><script>(function(h,g,l,k,j,i){j=h.createElement(g),i=h.getElementsByTagName(g)[0],
j.src="//"+l+".disqus.com/"+k+".js",i.parentNode.insertBefore(j,i)})
(document,"script","ehjanghexo","count");
</script></body></html>