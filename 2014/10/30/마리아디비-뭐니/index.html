<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="(loop (print (eval (read))))" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>마리아디비.. 뭐니? - (loop (print (eval (read))))</title><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro"><link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Handlee" type="text/css"><style type="text/css">.fb-share-button , .twitter-share-button {
  vertical-align: text-bottom;
  margin-left : 5px;
}
</style><link rel="stylesheet" href="/css/main.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    processEscapes: true
  }
});</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for(i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/javascript">var switchTo5x=true;</script><script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script><script type="text/javascript">stLight.options({publisher: "3df02cad-979e-4347-be4c-94fe98b99af9", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script></head><body><div id="fb-root"></div><script type="text/javascript">(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/ko_KR/sdk.js#xfbml=1&appId=783844121725729&version=v2.0";
    fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script><script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script><header class="head"><h1 class="head-title u-fl"><a href="/">(loop (print (eval (read))))</a></h1><h4 class="sub-title u-fl">;;닭집을 차리기 위한 여정</h4><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="[object Object]" class="head-nav__link">0</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2014-10-30T13:06:50.000Z" class="post__time">10월 30, 2014</time><h1 class="post__title"> <a href="/2014/10/30/마리아디비-뭐니/">마리아디비.. 뭐니?</a><div style="float:right;"><div data-href="/2014/10/30/마리아디비-뭐니/" data-layout="button_count" class="fb-share-button"></div><a href="https://twitter.com/share" data-url="http://zerosumz.github.io/2014/10/30/마리아디비-뭐니/" data-via="k_racketeer" class="twitter-share-button"></a></div></h1></header><div class="post__main echo"><h3 id="뭔가-지금-이상한-일이-일어나고-있는거-가튼디"><a href="#뭔가-지금-이상한-일이-일어나고-있는거-가튼디" class="headerlink" title="뭔가 지금 이상한 일이 일어나고 있는거 가튼디.."></a>뭔가 지금 이상한 일이 일어나고 있는거 가튼디..</h3><p>새로 일을 시작해서 db로 마리아디비를 골랐다.<br>근데 요놈이 mysql하고 똑같다. 버그까지 -_-;<br>커넥션풀을 죽이는 wait_timeout 설정이 있어서 우회하고<br>같은 상황을 또 마주하게 됐다.</p>
<figure class="highlight plain"><figcaption><span>my.cnf</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">max_connections         = 100</div><div class="line">connect_timeout         = 5</div><div class="line">wait_timeout            = 60</div><div class="line">max_allowed_packet      = 16M</div><div class="line">thread_cache_size       = 128</div><div class="line">sort_buffer_size        = 4M</div><div class="line">bulk_insert_buffer_size = 16M</div><div class="line">tmp_table_size          = 32M</div><div class="line">max_heap_table_size     = 32M</div></pre></td></tr></table></figure>
<p>어라? wait_timeout 이 60 이네?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">MariaDB [(none)]&gt; show variables like &apos;%timeout&apos;;</div><div class="line">+-----------------------------+----------+</div><div class="line">| Variable_name               | Value    |</div><div class="line">+-----------------------------+----------+</div><div class="line">| connect_timeout             | 5        |</div><div class="line">| delayed_insert_timeout      | 300      |</div><div class="line">| innodb_flush_log_at_timeout | 1        |</div><div class="line">| innodb_lock_wait_timeout    | 50       |</div><div class="line">| innodb_rollback_on_timeout  | OFF      |</div><div class="line">| interactive_timeout         | 28800    |</div><div class="line">| lock_wait_timeout           | 31536000 |</div><div class="line">| net_read_timeout            | 30       |</div><div class="line">| net_write_timeout           | 60       |</div><div class="line">| slave_net_timeout           | 3600     |</div><div class="line">| thread_pool_idle_timeout    | 60       |</div><div class="line">| wait_timeout                | 28800    |</div><div class="line">+-----------------------------+----------+</div><div class="line">12 rows in set (0.00 sec)</div></pre></td></tr></table></figure>
<p>어라 여기서는 28800 이네?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">MariaDB [(none)]&gt; show processlist;</div><div class="line">+----+------+--------------------+----------+---------+------+-------+------------------+----------+</div><div class="line">| Id | User | Host               | db       | Command | Time | State | Info             | Progress |</div><div class="line">+----+------+--------------------+----------+---------+------+-------+------------------+----------+</div><div class="line">| 51 | root | localhost          | NULL     | Query   |    0 | init  | show processlist |    0.000 |</div><div class="line">| 53 | xxx  | xxx.xx.xx.xx:50258 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 54 | xxx  | xxx.xx.xx.xx:50259 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 55 | xxx  | xxx.xx.xx.xx:50260 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 56 | xxx  | xxx.xx.xx.xx:50261 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 57 | xxx  | xxx.xx.xx.xx:50262 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 58 | xxx  | xxx.xx.xx.xx:50263 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 59 | xxx  | xxx.xx.xx.xx:50264 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 60 | xxx  | xxx.xx.xx.xx:50265 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 61 | xxx  | xxx.xx.xx.xx:50266 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 62 | xxx  | xxx.xx.xx.xx:50267 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 63 | xxx  | xxx.xx.xx.xx:50268 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 64 | xxx  | xxx.xx.xx.xx:50269 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 65 | xxx  | xxx.xx.xx.xx:50270 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 66 | xxx  | xxx.xx.xx.xx:50271 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 67 | xxx  | xxx.xx.xx.xx:50272 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 68 | xxx  | xxx.xx.xx.xx:50273 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">+----+------+--------------------+----------+---------+------+-------+------------------+----------+</div></pre></td></tr></table></figure>
<p>계속 보고있지 뭐.<br>60초가 지나니까 다 죽어 없어짐.<br>wait_timeout 을 10으로 조정. 역시 10초만에 다 죽음.</p>
<p>my.cnf 에 있는 설정값이 제대로 나오지 않는 것으로.<br>야…</p>
</div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/mariadb/" class="post__tag__link">mariadb,</a></li></ul><a href="/2014/10/30/마리아디비-뭐니/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article><div class="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript></div></div></main><footer class="foot"><div class="foot-copy u-fl">&copy; 2016 euhyen ~_~</div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/2014/12/26/Best-Practice/" class="page-menu__link icon-arrow-left"></a></li><li class="page-menu__item"><a title="Next" href="/2014/10/08/네이밍에-대해서/" class="page-menu__link icon-arrow-right"></a></li></menu></footer><script>(function(h,g,l,k,j,i){j=h.createElement(g),i=h.getElementsByTagName(g)[0],
j.src="//"+l+".disqus.com/"+k+".js",i.parentNode.insertBefore(j,i)})
(document,"script","ehjanghexo","embed");
</script></body></html>