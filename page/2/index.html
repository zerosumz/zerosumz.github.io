<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="(loop (print (eval (read))))" type="application/atom+xml"><link rel="icon" href="/favicon.png"><title>(loop (print (eval (read))))</title><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro"><link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Handlee" type="text/css"><style type="text/css">.fb-share-button , .twitter-share-button {
  vertical-align: text-bottom;
  margin-left : 5px;
}
</style><link rel="stylesheet" href="/css/main.css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    processEscapes: true
  }
});</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  }
});</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for(i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/javascript">var switchTo5x=true;</script><script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script><script type="text/javascript">stLight.options({publisher: "3df02cad-979e-4347-be4c-94fe98b99af9", doNotHash: false, doNotCopy: false, hashAddressBar: false});</script></head><body><div id="fb-root"></div><script type="text/javascript">(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/ko_KR/sdk.js#xfbml=1&appId=783844121725729&version=v2.0";
    fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script><script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script><header class="head"><h1 class="head-title u-fl"><a href="/">(loop (print (eval (read))))</a></h1><h4 class="sub-title u-fl">;;닭집을 차리기 위한 여정</h4><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/" class="head-nav__link">Home</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2015-03-14T09:36:42.000Z" class="post__time">3월 14, 2015</time><h1 class="post__title"> <a href="/2015/03/14/realy-need-service-layer/">서비스 레이어가 *정말로* 필요한가?</a><div style="float:right;"><div data-href="/2015/03/14/realy-need-service-layer/" data-layout="button_count" class="fb-share-button"></div><a href="https://twitter.com/share" data-url="http://zerosumz.github.io/2015/03/14/realy-need-service-layer/" data-via="k_racketeer" class="twitter-share-button"></a></div></h1></header><div class="post__main echo"><h3 id="간단하게-할-수-있으면-간단하게-해라"><a href="#간단하게-할-수-있으면-간단하게-해라" class="headerlink" title="간단하게 할 수 있으면 간단하게 해라."></a>간단하게 할 수 있으면 간단하게 해라.</h3><p>맞지 않나? 간단히 할 수 있는일을 왜 안 간단하게 하는지 모르겠다.<br>무슨 디커플링 어쩌구 하는데, 단 한번 쓰일 메서드 내지는 다음에 쓰일지 말지 애매한 메서드까지 왜 서비스 레이어 위에 올리는걸까?<br>왜 소스코드를 늘리고 더 복잡하게 만드는걸까? 이해가 안된다.<br>간단히 Authentication 만 봐도 그렇다. 인증 과정이 여러 포인트에서 지금 당장 일어나고 있다면 모를까, 최초 코드 작성시점에서 벌써 그런 사정을 고려할 필요는 없다.<br>이게 스프링 커뮤니티에서 추천하는 jdk프록시와 만나 impl 서비스 레이어를 만드는 것으로 더 복잡해진다.</p>
<blockquote>
<p><code>LoginController</code> -&gt; <code>LoginService</code> -&gt; <code>LoginServiceImpl</code> -&gt; <code>UserDao</code> -&gt; UserMapper</p>
</blockquote>
<p>컨트롤러에 비즈니스 로직을 집어넣는것이 나쁘다 (내지는 바람직하지 않다) 고 하는게 널리 알려진 말이지만,<br>지금껏 경험한 바로는 그런 말이 이해가 안될정도로, 그저 똑같은 메서드를 가진 서비스 클래스를 하나 더 만들뿐이다.</p>
<p>어떤 개념을 하나 더 두는것이 아무리 일정한 컨벤션을 가지고 있고 나중에 쓸모가 <strong>있을지도 모른다</strong> 할지라도 가장 좋은건 그냥 없는게 가장 좋지 않나?</p>
<p>예를들면 인증은 그냥 이런 코드로도 충분하지 않나 한다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RootController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Resource</span>(name = <span class="string">"session"</span>)</div><div class="line">    Session session;</div><div class="line"></div><div class="line">    <span class="meta">@Inject</span></div><div class="line">    UserMapper userMapper;</div><div class="line"></div><div class="line">    <span class="meta">@Inject</span></div><div class="line">    PostMapper postMapper;</div><div class="line"></div><div class="line">    <span class="meta">@Inject</span></div><div class="line">    FooService fooService;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">root</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span> (session.getUser() == <span class="keyword">null</span>)</div><div class="line">            <span class="keyword">return</span> <span class="string">"redirect:/page/hello"</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            <span class="keyword">return</span> <span class="string">"redirect:/page/home"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Authorized</span>(to = Type.PUBLIC)</div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/page/hello"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">hello</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"/jsp/hello.jsp"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/page/home"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">home</span><span class="params">()</span> </span>&#123;</div><div class="line">        List&lt;Post&gt; posts = postMapper.select();</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"/jsp/home.jsp"</span>).addObject(<span class="string">"posts"</span>, posts);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Authorized</span>(to = Type.PUBLIC)</div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/proc/login"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(</span></span></div><div class="line">        @RequestParam(required = <span class="keyword">true</span>) String name,</div><div class="line">        @<span class="title">RequestParam</span><span class="params">(required = <span class="keyword">true</span>)</span> String password</div><div class="line">    ) &#123;</div><div class="line">        User user = userMapper.selectByLogin(name, password);</div><div class="line">        <span class="keyword">if</span> (user == <span class="keyword">null</span>)</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchUserException();</div><div class="line"></div><div class="line">        session.setUser(user);</div><div class="line">        <span class="keyword">return</span> <span class="string">"redirect:/"</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/proc/logout"</span>)</div><div class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">logout</span><span class="params">()</span> </span>&#123;</div><div class="line">        session.setUser(<span class="keyword">null</span>);</div><div class="line">        <span class="keyword">return</span> <span class="string">"redirect:/"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<link href="/css/prism-dark.css" rel="stylesheet"></div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/service/" class="post__tag__link">service</a></li><li class="post__tag__item"><a href="/tags/layer/" class="post__tag__link">layer</a></li><li class="post__tag__item"><a href="/tags/mvc/" class="post__tag__link">mvc</a></li></ul><a href="/2015/03/14/realy-need-service-layer/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2015-03-13T03:36:29.000Z" class="post__time">3월 13, 2015</time><h1 class="post__title"> <a href="/2015/03/13/Service/">트랜잭션과 aspectj</a><div style="float:right;"><div data-href="/2015/03/13/Service/" data-layout="button_count" class="fb-share-button"></div><a href="https://twitter.com/share" data-url="http://zerosumz.github.io/2015/03/13/Service/" data-via="k_racketeer" class="twitter-share-button"></a></div></h1></header><div class="post__main echo"><h3 id="유일하게-쓸만한"><a href="#유일하게-쓸만한" class="headerlink" title="유일하게 쓸만한.."></a>유일하게 쓸만한..</h3><p>그동안 쭉 cglib 프록시를 썼었다. 아무래도 cglib의 프록시 방식이 substance를 만드는 방식이다보니,<br>내부 메서드 호출에 대해서도 잘 감싸주겠지 생각했었는데 알아보고 실험해보니 jdk프록시와 다를바없이 동작하더라는..</p>
<p>예를들어 간단히 이런 코드를 돌려보면</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Service</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FooService</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Inject</span></div><div class="line">	PostMapper postMapper;</div><div class="line"></div><div class="line">    <span class="meta">@Inject</span></div><div class="line">	UserMapper userMapper;</div><div class="line"></div><div class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRED)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertFoo</span><span class="params">(User user, Post post)</span> </span>&#123;</div><div class="line">		userMapper.insert(user);</div><div class="line">		insertBar(post);</div><div class="line">	    <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"fucking fucked!!"</span>);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">    <span class="meta">@Transactional</span>(propagation = Propagation.REQUIRES_NEW)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertBar</span><span class="params">(Post post)</span> </span>&#123;</div><div class="line">		postMapper.insert(post);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>예상과는 다르게 postMapper.insert(post) 마저 롤백되어 버린다.<br>실제로 브레이크 포인트를 걸어가며 디버깅해보면 프록시를 통하지 않고 다이렉트로 직접 호출하고 있다.<br>substance인데 왜 ㅅㅂ 존나 노이해..</p>
<p>결국 유일하게 쓸만한 솔루션은 그냥 닥치고 <strong><em>AspectJ</em></strong> 라는 거다. <strong><em>AspectJ</em></strong> 를 쓰면 아무런 문제가 생기지 않는다.<br><s>(혹은 cglib을 고쳐서 쓰거나…)</s></p>
<p>이렇게 동작하는것만 보장되면 구차하게 계속 서비스를 안 쪼개도 되고 템플릿 패턴을 쓸 수 있게된다.<br>생각해보면 컨트롤러와 서비스의 계층을 확실하게 나누는데도 도움이 된다. 예를들어 일반적인 처리는 컨트롤러에서, 특정 프로세스가 2회 이상 반복되는 경우에 템플릿 서비스로 계층화를 시키는게 가능하다. 이러면 소스를 줄이는데도 크게 도움이되고, 서비스== 템플릿 이므로 어떤 서비스가 어디서 호출되는지 고민할 필요도 없어진다.</p>
<link href="/css/prism-dark.css" rel="stylesheet"></div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/Transactional/" class="post__tag__link">Transactional</a></li><li class="post__tag__item"><a href="/tags/AspectJ/" class="post__tag__link">AspectJ</a></li><li class="post__tag__item"><a href="/tags/template-pattern/" class="post__tag__link">template pattern</a></li></ul><a href="/2015/03/13/Service/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-12-26T01:06:03.000Z" class="post__time">12월 26, 2014</time><h1 class="post__title"> <a href="/2014/12/26/Best-Practice/">Best Practice</a><div style="float:right;"><div data-href="/2014/12/26/Best-Practice/" data-layout="button_count" class="fb-share-button"></div><a href="https://twitter.com/share" data-url="http://zerosumz.github.io/2014/12/26/Best-Practice/" data-via="k_racketeer" class="twitter-share-button"></a></div></h1></header><div class="post__main echo"><p>이번에 이직준비를 하면서 한 회사로부터 면접 주제를 받았는데 바로 저 베스트 프랙티스에 대한 PT 였다.<br>주제도 주제이고, 정장입고 하래서 바로 포기했음.<br>여튼 이것에 대해서는 사실 기존에 하던 생각이 있어서 오랫만에 글을 적어봄.</p>
<h3 id="무얼위한"><a href="#무얼위한" class="headerlink" title="무얼위한?"></a>무얼위한?</h3><p>사전적 의미로는 <strong>모범사례</strong>. 하지만 이 IT하는 바닥에서는 여기에 여러 의미가 덧칠해져 마치 어떤 사상이나 종교 비슷한게 되버린다.<br>예를 들어 뭔가 할때 <em>그것은 spring-way- 하지 안항요</em> 라던가 <em>엔터프라이즈 규격에 맞게 해주세요</em> 라는 식.<br>좀 더 노골적으로 말하면 <strong>어떤 무리</strong> 가 있고 그들의 생각은 <em>시간은 없고 일은 간지나게 해야겠으니</em> 복사 붙여넣기 하여도 문제 없을만한 <em>코드</em> 가 바로 베스트 프랙티스 정도가 되는거시다.</p>
<p>도입부가 논리비약이 아주 심한데 뭐, 재밌으니까 계속 가봄.</p>
<h3 id="Guice-vs-Spring"><a href="#Guice-vs-Spring" class="headerlink" title="Guice vs Spring"></a>Guice vs Spring</h3><p>유명한 DI 프레임워크로 스프링과 구글쥬스가 있다. 자 어떤게 Best Practice 인가?</p>
<h3 id="Autowire-vs-Inject"><a href="#Autowire-vs-Inject" class="headerlink" title="Autowire vs Inject"></a>Autowire vs Inject</h3><p>위에서 스프링을 선택했다면 또 선택지가 두 개 생긴다. 자 <code>@Autowire</code> 와 <code>@Inject</code> 어노테이션 중 무엇이 Best Practice 인가?<br>참고로 자바 표준은 <code>@Inject</code> 어노테이션이다.</p>
<h3 id="XML-vs-Java-Config"><a href="#XML-vs-Java-Config" class="headerlink" title="XML vs Java Config"></a>XML vs Java Config</h3><p>자 스프링을 선택했다면 또 선택지가 있다. xml로 <code>applicationContext.xml</code> 파일을 만들것인가? 하는것.<br>참고로 구글쥬스를 선택했다면 autowire 니 xml 이니 하는것을 고민할 필요가 없다. 없으니까. 10년도 더 전부터.</p>
<h3 id="jdk-proxy-vs-cglib-proxy"><a href="#jdk-proxy-vs-cglib-proxy" class="headerlink" title="jdk proxy vs cglib proxy"></a>jdk proxy vs cglib proxy</h3><p>jdk 프록시를 선택할 것이냐 아니면 cglib 프록시를 선택할 것이냐?<br>바꿔말해 interface 기반의 di를 할껀지? class 기반의 di를 할껀지?<br>또 바꿔말해 runtime 에 proxy를 생성할건지 아니면 거의- compile-time에 bytecode 조작을 통한 subclass를 만들건지?<br>다시말해 근본주의 노선인지? 아니면 실용주의 노선인지?</p>
<h3 id="myBatis-vs-hibernate"><a href="#myBatis-vs-hibernate" class="headerlink" title="myBatis vs hibernate"></a>myBatis vs hibernate</h3><p>단순하고 반복되는 코드를 패턴화해서, 유지보수까지는 바라지도 않고 개발중 정신이 혼미해지는거를 방지하는것은 좋다.<br>하지만 java -&gt; orm 노선은 현실적인 문제 몇가지를 해결하지 못하고 있다..<br>반면 myBatis는 존내 딱 자기 역할만하는데 그걸 참 잘함.</p>
<h3 id="java-vs-clojure"><a href="#java-vs-clojure" class="headerlink" title="java vs clojure"></a>java vs clojure</h3><p>그래서 말인데, orm 중 clojure 의 <code>sqlKorma</code> 같은게 정말 좋아보인다. 그냥 java 말고 clojure 만 쓰거나 두개를 같이 쓰는것은 어떤가?</p>
<h3 id="그래서-그래서…"><a href="#그래서-그래서…" class="headerlink" title="그래서, 그래서…"></a>그래서, 그래서…</h3><p>적어도, IT하는 바닥에서 어떤 진짜 사상 (예를들어 <code>OOP</code> 같은거) 을 좀더 잘 드러내기 위한 Best Practice 같은건 있을 수 있다.<br>하지만 대부분의 사람들이 그걸 원하는지는 별개 문제임.<br>자신이 바라는게 복붙 가능한 코드라면 사실은 Best Practice 의 반대를 바라는게 아닐까?</p>
<link href="/css/prism-dark.css" rel="stylesheet"></div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/헛소리/" class="post__tag__link">헛소리</a></li><li class="post__tag__item"><a href="/tags/spring/" class="post__tag__link">spring</a></li></ul><a href="/2014/12/26/Best-Practice/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-10-30T13:06:50.000Z" class="post__time">10월 30, 2014</time><h1 class="post__title"> <a href="/2014/10/30/마리아디비-뭐니/">마리아디비.. 뭐니?</a><div style="float:right;"><div data-href="/2014/10/30/마리아디비-뭐니/" data-layout="button_count" class="fb-share-button"></div><a href="https://twitter.com/share" data-url="http://zerosumz.github.io/2014/10/30/마리아디비-뭐니/" data-via="k_racketeer" class="twitter-share-button"></a></div></h1></header><div class="post__main echo"><h3 id="뭔가-지금-이상한-일이-일어나고-있는거-가튼디"><a href="#뭔가-지금-이상한-일이-일어나고-있는거-가튼디" class="headerlink" title="뭔가 지금 이상한 일이 일어나고 있는거 가튼디.."></a>뭔가 지금 이상한 일이 일어나고 있는거 가튼디..</h3><p>새로 일을 시작해서 db로 마리아디비를 골랐다.<br>근데 요놈이 mysql하고 똑같다. 버그까지 -_-;<br>커넥션풀을 죽이는 wait_timeout 설정이 있어서 우회하고<br>같은 상황을 또 마주하게 됐다.</p>
<figure class="highlight plain"><figcaption><span>my.cnf</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">max_connections         = 100</div><div class="line">connect_timeout         = 5</div><div class="line">wait_timeout            = 60</div><div class="line">max_allowed_packet      = 16M</div><div class="line">thread_cache_size       = 128</div><div class="line">sort_buffer_size        = 4M</div><div class="line">bulk_insert_buffer_size = 16M</div><div class="line">tmp_table_size          = 32M</div><div class="line">max_heap_table_size     = 32M</div></pre></td></tr></table></figure>
<p>어라? wait_timeout 이 60 이네?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">MariaDB [(none)]&gt; show variables like &apos;%timeout&apos;;</div><div class="line">+-----------------------------+----------+</div><div class="line">| Variable_name               | Value    |</div><div class="line">+-----------------------------+----------+</div><div class="line">| connect_timeout             | 5        |</div><div class="line">| delayed_insert_timeout      | 300      |</div><div class="line">| innodb_flush_log_at_timeout | 1        |</div><div class="line">| innodb_lock_wait_timeout    | 50       |</div><div class="line">| innodb_rollback_on_timeout  | OFF      |</div><div class="line">| interactive_timeout         | 28800    |</div><div class="line">| lock_wait_timeout           | 31536000 |</div><div class="line">| net_read_timeout            | 30       |</div><div class="line">| net_write_timeout           | 60       |</div><div class="line">| slave_net_timeout           | 3600     |</div><div class="line">| thread_pool_idle_timeout    | 60       |</div><div class="line">| wait_timeout                | 28800    |</div><div class="line">+-----------------------------+----------+</div><div class="line">12 rows in set (0.00 sec)</div></pre></td></tr></table></figure>
<p>어라 여기서는 28800 이네?</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">MariaDB [(none)]&gt; show processlist;</div><div class="line">+----+------+--------------------+----------+---------+------+-------+------------------+----------+</div><div class="line">| Id | User | Host               | db       | Command | Time | State | Info             | Progress |</div><div class="line">+----+------+--------------------+----------+---------+------+-------+------------------+----------+</div><div class="line">| 51 | root | localhost          | NULL     | Query   |    0 | init  | show processlist |    0.000 |</div><div class="line">| 53 | xxx  | xxx.xx.xx.xx:50258 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 54 | xxx  | xxx.xx.xx.xx:50259 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 55 | xxx  | xxx.xx.xx.xx:50260 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 56 | xxx  | xxx.xx.xx.xx:50261 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 57 | xxx  | xxx.xx.xx.xx:50262 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 58 | xxx  | xxx.xx.xx.xx:50263 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 59 | xxx  | xxx.xx.xx.xx:50264 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 60 | xxx  | xxx.xx.xx.xx:50265 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 61 | xxx  | xxx.xx.xx.xx:50266 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 62 | xxx  | xxx.xx.xx.xx:50267 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 63 | xxx  | xxx.xx.xx.xx:50268 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 64 | xxx  | xxx.xx.xx.xx:50269 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 65 | xxx  | xxx.xx.xx.xx:50270 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 66 | xxx  | xxx.xx.xx.xx:50271 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 67 | xxx  | xxx.xx.xx.xx:50272 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">| 68 | xxx  | xxx.xx.xx.xx:50273 | xxxxxxxx | Sleep   |    6 |       | NULL             |    0.000 |</div><div class="line">+----+------+--------------------+----------+---------+------+-------+------------------+----------+</div></pre></td></tr></table></figure>
<p>계속 보고있지 뭐.<br>60초가 지나니까 다 죽어 없어짐.<br>wait_timeout 을 10으로 조정. 역시 10초만에 다 죽음.</p>
<p>my.cnf 에 있는 설정값이 제대로 나오지 않는 것으로.<br>야…</p>
<link href="/css/prism-dark.css" rel="stylesheet"></div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/mariadb/" class="post__tag__link">mariadb,</a></li></ul><a href="/2014/10/30/마리아디비-뭐니/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-10-08T01:10:46.000Z" class="post__time">10월 8, 2014</time><h1 class="post__title"> <a href="/2014/10/08/네이밍에-대해서/">네이밍에 대해서</a><div style="float:right;"><div data-href="/2014/10/08/네이밍에-대해서/" data-layout="button_count" class="fb-share-button"></div><a href="https://twitter.com/share" data-url="http://zerosumz.github.io/2014/10/08/네이밍에-대해서/" data-via="k_racketeer" class="twitter-share-button"></a></div></h1></header><div class="post__main echo"><h2 id="헝가리안-표기법"><a href="#헝가리안-표기법" class="headerlink" title="헝가리안 표기법?"></a>헝가리안 표기법?</h2><p><s>이제는 이런 표기를 안 쓸거라고 생각하지만</s> 헝가리안 표기법이라는게 있다. 변수앞에 타입을 접두어로 붙이자는 것으로 주로 마소에서 개발해서 배포하는 vc를 쓰는 프로젝트에서 이런 표기법이 주로 보였<em>었</em>다.</p>
<figure class="highlight c"><figcaption><span>본격MSDN예제</span><a href="http://msdn.microsoft.com/en-us/library/windows/desktop/aa383751(v=vs.85).aspx" target="_blank" rel="external">link</a></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"sy.h"</span></span></div><div class="line"><span class="keyword">extern</span> <span class="keyword">int</span> *rgwDic;</div><div class="line"><span class="keyword">extern</span> <span class="keyword">int</span> bsyMac;</div><div class="line"><span class="function"><span class="keyword">struct</span> SY *<span class="title">PsySz</span><span class="params">(<span class="keyword">char</span> sz[])</span></span></div><div class="line">   &#123;</div><div class="line">   <span class="keyword">char</span> *pch;</div><div class="line">   <span class="keyword">int</span> cch;</div><div class="line">   <span class="keyword">struct</span> SY *psy, *PsyCreate();</div><div class="line">   <span class="keyword">int</span> *pbsy;</div><div class="line">   <span class="keyword">int</span> cwSz;</div><div class="line">   <span class="keyword">unsigned</span> wHash=<span class="number">0</span>;</div><div class="line">   pch=sz;</div><div class="line">   <span class="keyword">while</span> (*pch!=<span class="number">0</span></div><div class="line">      wHash=(wHash&lt;&gt;<span class="number">11</span>+*pch++;</div><div class="line">   cch=pch-sz;</div><div class="line">   pbsy=&amp;rgbsyHash[(wHash&amp;<span class="number">077777</span>)%cwHash];</div><div class="line">   <span class="keyword">for</span> (; *pbsy!=<span class="number">0</span>; pbsy = &amp;psy-&gt;bsyNext)</div><div class="line">      &#123;</div><div class="line">      <span class="keyword">char</span> *szSy;</div><div class="line">      szSy= (psy=(<span class="keyword">struct</span> SY*)&amp;rgwDic[*pbsy])-&gt;sz;</div><div class="line">      pch=sz;</div><div class="line">      <span class="keyword">while</span> (*pch==*szSy++)</div><div class="line">         &#123;</div><div class="line">         <span class="keyword">if</span> (*pch++==<span class="number">0</span>)</div><div class="line">            <span class="keyword">return</span> (psy);</div><div class="line">         &#125;</div><div class="line">      &#125;</div><div class="line">   cwSz=<span class="number">0</span>;</div><div class="line">   <span class="keyword">if</span> (cch&gt;=<span class="number">2</span>)</div><div class="line">      cwSz=(cch<span class="number">-2</span>/<span class="keyword">sizeof</span>(<span class="keyword">int</span>)+<span class="number">1</span>;</div><div class="line">   *pbsy=(<span class="keyword">int</span> *)(psy=PsyCreate(cwSY+cwSz))-rgwDic;</div><div class="line">   Zero((<span class="keyword">int</span> *)psy,cwSY);</div><div class="line">   bltbyte(sz, psy-&gt;sz, cch+<span class="number">1</span>);</div><div class="line">   <span class="keyword">return</span>(psy);</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p><s>이런ㅆㅂ뭐라는거야</s></p>
<h2 id="문제점"><a href="#문제점" class="headerlink" title="문제점"></a>문제점</h2><p>예제에서 나오는 변수명은 사실 상당히 짧다. 본래의미를 축약하지 않고 다 써도 상당히 짧은 편일 것이다. 헌데 그 의미마저도 괴상한 접두어 때문에 <strong>가려져서</strong> 잘 보이지 않는다. 실제 업무용 어플리케이션은 이보다 훨씬 길고 다양한 의미를 가진 변수명을 쓰게 되는데 이럴때 이 <strong>의미가 가려지는 현상</strong> 은 훨씬 심해진다. 과연 저 괴상한 접두어들이 필요한가? 예를들어 불린타입의 숫자인지 아닌지에 대한 값이 들어있는 변수를 헝가리안 표기로 나타내면 <code>bNumber</code> 이다. 왜 안 <code>isNumber</code> ? 또 스킴이나 루비같은 언어에서는 가장 좋은 컨벤션을 쓴다( <code>number?</code> ). 게다가 축약된 접두어를 붙이느라 길어진 변수명을 짧게/접두어와 어울리게 만드느라 변수명을 줄여쓰는 사람들이 많은데 그러자면 <code>bNo</code> 가 된다. 여기에 포인터를 의미한다는 p를 붙여 <code>pbNo</code>. 값을 얻는답시고 <code>*pbNo</code>.</p>
<p>물론 이같은 것들은 이제 없으나 요런 사상은 아직도 여기저기에 남아있다. 주로 데이터베이스에 말이지.</p>
<link href="/css/prism-dark.css" rel="stylesheet"></div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/naming-hungarian/" class="post__tag__link">naming, hungarian</a></li></ul><a href="/2014/10/08/네이밍에-대해서/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-09-25T09:38:03.000Z" class="post__time">9월 25, 2014</time><h1 class="post__title"> <a href="/2014/09/25/Jade/">Jade?</a><div style="float:right;"><div data-href="/2014/09/25/Jade/" data-layout="button_count" class="fb-share-button"></div><a href="https://twitter.com/share" data-url="http://zerosumz.github.io/2014/09/25/Jade/" data-via="k_racketeer" class="twitter-share-button"></a></div></h1></header><div class="post__main echo"><h3 id="hexo테마"><a href="#hexo테마" class="headerlink" title="hexo테마"></a>hexo테마</h3><p>hexo로 블로그를 만들면서 테마때문에 꽤 골치를썩음.<br>일단 요 테마 strict  는 <a href="http://jade-lang.com" target="_blank" rel="external">jade</a> 라는 nodejs템플릿 라이브러리를 쓰고있음<br>그런데 보면 jade는 일정 형식을 가진 소스코드 -&gt;  컴파일 -&gt; html 의 구조를 갖는 템플릿 엔진이었다.</p>
<p>몇번 굴려보고 느낀점은..<br>야 이럴거면 그냥 clojure 하지;..</p>
<h3 id="어쩌다보니-그냥-clojure-얘기"><a href="#어쩌다보니-그냥-clojure-얘기" class="headerlink" title="어쩌다보니 그냥 clojure 얘기"></a>어쩌다보니 그냥 clojure 얘기</h3><p>클로져 (혹은 다른 lisp, scheme 류) 에서는 이미 저런 시도가 흔하다.</p>
<figure class="highlight clojure"><figcaption><span>hiccup.core.html</span><a href="https://github.com/weavejester/hiccup" target="_blank" rel="external">link</a></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">;; user=&gt;</span></div><div class="line"></div><div class="line">(<span class="name">html</span> [<span class="symbol">:div#foo.bar.baz</span> <span class="string">"bang"</span>])</div><div class="line"></div><div class="line"><span class="comment">;=&gt; "&lt;div id=\"foo\" class=\"bar baz\"&gt;bang&lt;/div&gt;"</span></div><div class="line"></div><div class="line"><span class="comment">;; user=&gt;</span></div><div class="line"> (<span class="name">html</span> [<span class="symbol">:ul</span></div><div class="line">        (<span class="name"><span class="builtin-name">for</span></span> [x (<span class="name"><span class="builtin-name">range</span></span> <span class="number">1</span> <span class="number">4</span>)]</div><div class="line">		       [<span class="symbol">:li</span> x])])</div><div class="line"></div><div class="line"><span class="comment">;=&gt; "&lt;ul&gt;&lt;li&gt;1&lt;/li&gt;&lt;li&gt;2&lt;/li&gt;&lt;li&gt;3&lt;/li&gt;&lt;/ul&gt;"</span></div></pre></td></tr></table></figure>
<p>클로져의 웹프레임워크 라이브러리중 하나인 lib-noir 를 쓰면 <code>defpage</code> 매크로를 써서 url에 즉시 바인딩 시킬 수 있다.</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(<span class="name">defpage</span> <span class="string">"/test"</span> []</div><div class="line">  (<span class="name">hic/html</span> [<span class="symbol">:html</span></div><div class="line">             [<span class="symbol">:head</span>]</div><div class="line">              [<span class="symbol">:body</span></div><div class="line">               [<span class="symbol">:h1</span> <span class="string">"Hello"</span>]]]))</div></pre></td></tr></table></figure>
<p>지금도 잘 쓰고있는 자바 라이브러리로 <a href="http://www.stripesframework.org/display/stripes/Layout+Reuse" target="_blank" rel="external">stripe</a> 라는게 있다.<br>앞서 얘기한 재료를 잘 반죽하여 <code>stripe</code>를 구현할 수 있다.</p>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">(<span class="name">defpartial</span> layout [ &amp; &#123;<span class="symbol">:keys</span> [script</div><div class="line">                               header</div><div class="line">                               content</div><div class="line">                               footer]&#125;]</div><div class="line">  (<span class="name">html5</span></div><div class="line">   [<span class="symbol">:head</span></div><div class="line">    [<span class="symbol">:title</span> <span class="string">"my-website"</span>]</div><div class="line">    (<span class="name">include-css</span> <span class="string">"/css/reset.css"</span>)</div><div class="line">    (<span class="name">include-js</span> <span class="string">"/js/main.js"</span>)</div><div class="line">    `(~@script)]</div><div class="line">   [<span class="symbol">:body</span></div><div class="line">    [<span class="symbol">:div#header</span> `(~@header)]</div><div class="line">    [<span class="symbol">:div#wrapper</span> `(~@content)]</div><div class="line">    [<span class="symbol">:div#tail</span> `(~@footer)]]))</div><div class="line"></div><div class="line">(<span class="name">defpage</span> <span class="string">"/foo/page/select"</span> []</div><div class="line">  (<span class="name">layout</span></div><div class="line">   <span class="symbol">:script</span> </div><div class="line">   [[<span class="symbol">:script</span> <span class="string">"my_website.core.alert_hello('hello');"</span>]]</div><div class="line">   <span class="symbol">:header</span></div><div class="line">   [[<span class="symbol">:h1</span> <span class="string">"Hello"</span>]]</div><div class="line">   </div><div class="line">   <span class="symbol">:content</span></div><div class="line">   [[<span class="symbol">:table</span> ]]))</div></pre></td></tr></table></figure>
<h3 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h3><p>물론 php, jsp 등 흔히 server page 라고 부르는 방식으로 만들수고 있고, html을 파싱해다가 원하는 부분만 코드가 개입하도록 할 수도 있다.<br>요건 개취인듯.<br>하지만 협업을 포기한다면 (다른데는 모르겠고, 우리나라에서는 <em><strong>반드시</strong></em> 포기해야한다)<br>clojure의 저 접근이 괜찮은듯.<br>jade는 몰라.</p>
<link href="/css/prism-dark.css" rel="stylesheet"></div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/nodejs-jade-template/" class="post__tag__link">nodejs, jade, template</a></li></ul><a href="/2014/09/25/Jade/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-09-24T15:59:21.000Z" class="post__time">9월 25, 2014</time><h1 class="post__title"> <a href="/2014/09/25/contrib/">contrib</a><div style="float:right;"><div data-href="/2014/09/25/contrib/" data-layout="button_count" class="fb-share-button"></div><a href="https://twitter.com/share" data-url="http://zerosumz.github.io/2014/09/25/contrib/" data-via="k_racketeer" class="twitter-share-button"></a></div></h1></header><div class="post__main echo"><h2 id="깃헙에-공개한-오픈소스-모음"><a href="#깃헙에-공개한-오픈소스-모음" class="headerlink" title="깃헙에 공개한  오픈소스 모음"></a>깃헙에 공개한  오픈소스 모음</h2><h3 id="test-dies"><a href="#test-dies" class="headerlink" title="test-dies"></a>test-dies</h3><ul>
<li><a href="https://github.com/zerosumz/test-dies" target="_blank" rel="external">https://github.com/zerosumz/test-dies</a></li>
<li>markdown extra 의 테이블 문법으로 작성된 테이블을 데이터베이스의 테이블로 <ul>
<li>매 테스트메서드 호출시마다 인서트</li>
<li>매 호출이 끝난후 삭제</li>
</ul>
</li>
</ul>
<link href="/css/prism-dark.css" rel="stylesheet"></div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/contribute-opensource-open-github/" class="post__tag__link">contribute, opensource, open, github</a></li></ul><a href="/2014/09/25/contrib/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-09-24T15:12:53.000Z" class="post__time">9월 25, 2014</time><h1 class="post__title"> <a href="/2014/09/25/OO에-대한-느낌적-느낌/">OO에 대한 느낌적 느낌</a><div style="float:right;"><div data-href="/2014/09/25/OO에-대한-느낌적-느낌/" data-layout="button_count" class="fb-share-button"></div><a href="https://twitter.com/share" data-url="http://zerosumz.github.io/2014/09/25/OO에-대한-느낌적-느낌/" data-via="k_racketeer" class="twitter-share-button"></a></div></h1></header><div class="post__main echo"><h2 id="자바"><a href="#자바" class="headerlink" title="자바"></a>자바</h2><p>나는 주로 먹고살기위해 자바를 써왔다. 현재도 많은 사람들이 바로 이 이유로 자바를 선택한다.<br>OO는 멋지다. 솔직히 간지폭발이다. 하지만 자바를 위시한 현실에서는 별로 안 멋지고 안쓰느니만 못한 부분도 간간히 보인다.</p>
<h2 id="간단한-아이디어의-구현"><a href="#간단한-아이디어의-구현" class="headerlink" title="간단한 아이디어의 구현"></a>간단한 아이디어의 구현</h2><p>예를들어 이런 수식이 있다고 하자. 흔히 예제로 자주드는 시그마 표현식이다.</p>
<blockquote>
<p>$\sum\limits_{n=a}^b f(x) = f(a) + f(a+1) + … + f(b-1) + f(b)$</p>
</blockquote>
<p>이것을 다른 평범한 언어 -  예를들어 스킴이나 자바스크립트, 좀더 내려가서 C에서는 어떻게 구현할까?</p>
<figure class="highlight scheme"><figcaption><span>스킴</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">(<span class="name"><span class="builtin-name">define</span></span> (<span class="name">sigma</span> f a b)</div><div class="line">  (<span class="name"><span class="builtin-name">if</span></span> (<span class="name"><span class="builtin-name">&gt;</span></span> a b)</div><div class="line">      <span class="number">0</span></div><div class="line">	  (<span class="name"><span class="builtin-name">+</span></span> (<span class="name">f</span> a)</div><div class="line">	     (<span class="name">sigma</span> f (<span class="name">add1</span> a) b))))</div><div class="line"></div><div class="line">(<span class="name">sigma</span> (<span class="name">λ</span>(<span class="name">x</span>) (<span class="name"><span class="builtin-name">*</span></span> x x)) <span class="number">1</span> <span class="number">2</span>)</div><div class="line"><span class="comment">; =&gt; 5</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><figcaption><span>자바스크립트 </span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sigma</span>(<span class="params">f,a,b</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span>(a &gt; b)</div><div class="line">	    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    <span class="keyword">else</span></div><div class="line">	    <span class="keyword">return</span> f(a)</div><div class="line">		       + sigma(f, a+<span class="number">1</span>, b);</div><div class="line">&#125;</div><div class="line"></div><div class="line">sigma(<span class="function"><span class="keyword">function</span>(<span class="params">x</span>)</span>&#123;<span class="keyword">return</span> x*x&#125;, <span class="number">1</span>, <span class="number">2</span>);</div><div class="line"><span class="comment">// =&gt; 5</span></div></pre></td></tr></table></figure>
<figure class="highlight c"><figcaption><span>C</span></figcaption><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sigma</span><span class="params">(<span class="keyword">void</span>*, <span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">term</span><span class="params">(<span class="keyword">int</span>)</span></span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></div><div class="line">&#123;</div><div class="line">  <span class="built_in">printf</span>(<span class="string">"%d"</span> ,sigma(&amp;term, <span class="number">1</span>, <span class="number">2</span>));</div><div class="line">  <span class="comment">// =&gt; 5</span></div><div class="line">  <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sigma</span><span class="params">(<span class="keyword">void</span>* f, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</div><div class="line">  <span class="keyword">if</span>(a &gt; b)</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">  <span class="keyword">else</span> </div><div class="line">    <span class="keyword">return</span> ((<span class="keyword">int</span>(*)(<span class="keyword">int</span>))f)(a) + sigma(f, a + <span class="number">1</span>, b);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">term</span><span class="params">(<span class="keyword">int</span> i)</span></span>&#123;</div><div class="line">  <span class="keyword">return</span> i * i;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>하지만 자바에서는 OO의 이름으로 널 용서하지 않을것이다.<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> example;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		System.out.println(sigma(<span class="keyword">new</span> Term() &#123;</div><div class="line">			<span class="meta">@Override</span></div><div class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">term</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">				<span class="keyword">return</span> x * x;</div><div class="line">			&#125;</div><div class="line">		&#125;, <span class="number">1</span>, <span class="number">2</span>));</div><div class="line">	&#125;</div><div class="line">	<span class="comment">// =&gt; 5</span></div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">interface</span> <span class="title">Term</span> </span>&#123;</div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">term</span><span class="params">(<span class="keyword">int</span> x)</span></span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">sigma</span><span class="params">(Term f, <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span> (a &gt; b)</div><div class="line">			<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">		<span class="keyword">else</span></div><div class="line">			<span class="keyword">return</span> f.term(a) + sigma(f, a + <span class="number">1</span>, b);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>하지만 자바를 오래해서 그런지, (또한 돈을 벌어다줘서 그런지) 저런 표현도 나쁘지 않다는 생각이 든다.<br>아직까진 참을 수 있다. 오히려 저렇게 뭔가 <strong><em>명시적</em></strong>이고 <strong><em>구조적</em></strong>이고 <strong><em>엔터프라이지-</em></strong>하고 <strong><em>꾸띄르적</em></strong>이고 뭔가 저렇게 하면 세련되고 <strong><em>아트적인</em></strong> 느낌을 줄 것만 같다.</p>
<h2 id="복잡한-아이디어의-구현"><a href="#복잡한-아이디어의-구현" class="headerlink" title="복잡한 아이디어의 구현"></a>복잡한 아이디어의 구현</h2><p>현실세계로 돌아와서 자바로 허구헌날 만드는 웹 어플리케이션이나, 웹어플리케이션 혹은 웹 어플리케이션을 보자. 유행의 첨단을 주도하는 셀러브리티 트랜드 세터들이 매일 뭔가 프로퍼 웨이- 한 패턴이나 스타일을 들고 나온다. 그 중 하나가 aspect 다. <del>respect</del><br>자바는 이 aspect oriented programming 을 위해서 굉장히 여러 시도를 하였으며 관련 프로젝트도 여럿 나오게 된다. 현실에서 우리가 자주 보는 spring, spring-aop 가 바로 현실적인 표준으로 자리잡은 프로젝트라 할 만하다. 전자정부에도 있다 이거. 그런데,</p>
<ul>
<li>DI, aop 를 써서 무언가를 만드는것은 간지나고 좋다.</li>
<li>그런데 위에서 간단한 아이디어를 구현하는데에 이러한 복잡한 기능들이 방해가 되지는 않을까?</li>
<li>그러니까, 위에서 했던 간단히 익명 클래스 인스턴스를 넘겨받고 내부의 메서드를 호출하는등의 기능이 aop를 쓰면서도 잘 굴러갈까?</li>
</ul>
<p>경험상, 위의 예시들은 될 수도 있고, 안될 수 도 있다. 보통 jdk proxy를 쓰느냐, cglib proxy를 쓰느냐에 따라서 되고 안되는 것들이 생겨난다. 게다가 간단히 익명 클래스 인스턴스를 넘겨받는 일들을 스프링 웨이- 하게 하려면 (불과 몇년 전까지만 해도) xml 파일에다가 해당 빈의 스펙을 기술해야만 했다.</p>
<p>현실에서 가장 만나기 좋은 예시는 <strong>@Transactional</strong> 이다.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentService</span>&lt;<span class="title">REQ</span> <span class="keyword">extends</span> <span class="title">PayRequestable</span>, <span class="title">RESP</span> <span class="keyword">extends</span> <span class="title">PayResponseable</span>, <span class="title">PAY</span> <span class="keyword">extends</span> <span class="title">Payment</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> PAY <span class="title">draftPayment</span><span class="params">(<span class="keyword">long</span> paymentId, REQ payRequest, Order order)</span> <span class="keyword">throws</span> SystemException</span>;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> RESP <span class="title">requestPayment</span><span class="params">(REQ payRequest, Order order)</span> <span class="keyword">throws</span> SystemException</span>;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span>(propagation = Propagation.NOT_SUPPORTED)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">completePayment</span><span class="params">(PAY payment, RESP payResponse)</span> <span class="keyword">throws</span> SystemException</span>;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span>(propagation = Propagation.NOT_SUPPORTED)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">logPayment</span><span class="params">(User user, PAY payment, RESP response)</span></span>;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span></div><div class="line">	<span class="function"><span class="keyword">public</span> PAY <span class="title">process</span><span class="params">(Order order, <span class="keyword">long</span> paymentId, REQ payRequest)</span> <span class="keyword">throws</span> SystemException </span>&#123;</div><div class="line">	    <span class="comment">// .... 결제처리를 한다.</span></div><div class="line">		<span class="keyword">return</span> payment;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span>(propagation = Propagation.NEVER)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkExistingOrder</span><span class="params">(User user)</span> </span>&#123;</div><div class="line">	    <span class="comment">// .....</span></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Transactional</span>(propagation = Propagation.NESTED)</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">saveOrderItemsAppliedPromotion</span><span class="params">(Order order)</span> </span>&#123;</div><div class="line">	    <span class="comment">// .....</span></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>위의 시그마 표현식과 다를바 없는 간단한 아이디어지만 이 코드들이 제대로 동작하게 하기위해서 어노테이션의 특성을 또 파악하고 스프링의 설정상 함정을 회피하고 또한 하나의 스타일을 강요해야한다.</p>
<ul>
<li>별로 멋있지도 않고</li>
<li>불안하고 무섭고</li>
<li>힘들다</li>
</ul>
<p>결론은 많은 사람들이 간단한 아이디어를 포기하고 괴랄한 구현을 선호하게 된다. 서비스에서 내부 메서드를 호출하지 못하므로 그냥 서비스 인터페이스를 하나 더 만들고 서비스 구현체 클래스를 하나 더 만드세요 ~ 물론 다른 방법도 있지만 그건 표준적이지 못하고 팀워-크에 민폐를 끼치는 일이에요~ 무엇보다 무슨일이 생길지 몰라요~ 라고 하는 일들이 벌어진단 얘기.</p>
<p>수백줄에 이르는 xml이 왜 아직 남아있겠는가요?</p>
<h2 id="결론"><a href="#결론" class="headerlink" title="결론"></a>결론</h2><p>스킴이나 이쪽 동네에는 좀 다른 클래스와 제네릭 메서드를 구현하는 방법이 있긴 하지만…</p>
<ul>
<li>아직 늦지 않았다. 공무원을 하는게 좋다. 당장 공무원 공부를 시작하면 좋다.</li>
<li>왜 이런 자바쟁이 짓을 하고 있는지 모르겠다. 이런거 한다고 누가 알아주지도 않는다.</li>
<li>결론따위 없다. 내가 뭐 아는게 있어야지. 감히 신성한 패턴에 대해 논하다니 잠깐 미쳤었나 보다.</li>
</ul>
<link href="/css/prism-dark.css" rel="stylesheet"></div><footer class="post__foot u-cf"><ul class="post__tag u-fl"><li class="post__tag__item"><a href="/tags/java-OO-Object-Oriented-Spring/" class="post__tag__link">java, OO, Object-Oriented, Spring</a></li></ul><a href="/2014/09/25/OO에-대한-느낌적-느낌/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article><article class="post"><header class="post__head"><time datetime="2014-09-24T12:34:20.000Z" class="post__time">9월 24, 2014</time><h1 class="post__title"> <a href="/2014/09/24/하이/">하이</a><div style="float:right;"><div data-href="/2014/09/24/하이/" data-layout="button_count" class="fb-share-button"></div><a href="https://twitter.com/share" data-url="http://zerosumz.github.io/2014/09/24/하이/" data-via="k_racketeer" class="twitter-share-button"></a></div></h1></header><div class="post__main echo"><h2 id="첫글임"><a href="#첫글임" class="headerlink" title="첫글임."></a>첫글임.</h2><p>마크다운을 좋아하고<br>주로 emacs 등의 편집기를 써서 글쓰기를 좋아하는 사람들에게 괜찮은 툴 같다.</p>
<p> <strong> 중국</strong> 냄새가 너무 많이 나긴 하지만..</p>
<ul>
<li>리스트 테스트<ul>
<li>흠?</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span>&#123;</div><div class="line">    <span class="function">pubic <span class="keyword">void</span> <span class="title">bar</span><span class="params">()</span></span>&#123;</div><div class="line">	    System.out.println(<span class="string">"a"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">테이블</th>
<th style="text-align:center">테스트</th>
<th style="text-align:right">흠</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">안녕</td>
<td style="text-align:center">난</td>
<td style="text-align:right">웅이라구해</td>
</tr>
</tbody>
</table>
<link href="/css/prism-dark.css" rel="stylesheet"></div><footer class="post__foot u-cf"><a href="/2014/09/24/하이/#disqus_thread" class="post__foot-link u-fr">0 COMMENTS</a></footer></article></main><footer class="foot"><div class="foot-copy u-fl">&copy; 2017 euhyen ~_~</div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/" class="page-menu__link icon-arrow-left"></a></li><li class="page-menu__item"><span title="Next" class="page-menu__link icon-arrow-right page-menu__link--disabled"></span></li></menu></footer><script>(function(h,g,l,k,j,i){j=h.createElement(g),i=h.getElementsByTagName(g)[0],
j.src="//"+l+".disqus.com/"+k+".js",i.parentNode.insertBefore(j,i)})
(document,"script","ehjanghexo","count");
</script></body></html>